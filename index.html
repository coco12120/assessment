<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>伴侣关系评估工具</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f9f7fe 0%, #e3e0f7 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 15px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0d6ff;
            position: relative;
        }
        
        .header-badge {
            position: absolute;
            top: 15px;
            right: 20px;
            background: #5a4b9a;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        h1 {
            font-size: 2.5rem;
            color: #5a4b9a;
            margin-bottom: 15px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #6c63a0;
            max-width: 800px;
            margin: 0 auto;
            font-weight: 500;
        }
        
        .toolbar {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 20px;
            background: #6a5acd;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 0.95rem;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 8px rgba(106, 90, 205, 0.3);
        }
        
        .btn:hover {
            background: #5649b0;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(106, 90, 205, 0.4);
        }
        
        .btn-export {
            background: #27ae60;
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
        }
        
        .btn-export:hover {
            background: #219653;
            box-shadow: 0 6px 12px rgba(39, 174, 96, 0.4);
        }
        
        .btn-import {
            background: #f39c12;
            box-shadow: 0 4px 8px rgba(243, 156, 18, 0.3);
        }
        
        .btn-import:hover {
            background: #e67e22;
            box-shadow: 0 6px 12px rgba(243, 156, 18, 0.4);
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            margin: 30px 0;
            flex-wrap: wrap;
            background: white;
            border-radius: 12px;
            padding: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        .tab-btn {
            padding: 12px 25px;
            background: rgba(255, 255, 255, 0.7);
            border: none;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 8px;
            font-weight: 500;
        }
        
        .tab-btn.active {
            background: #6a5acd;
            font-weight: bold;
            color: white;
            box-shadow: 0 4px 8px rgba(106, 90, 205, 0.2);
        }
        
        .tab-content {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid #eee;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .evaluation-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .evaluation-table th {
            background: #6a5acd;
            color: white;
            padding: 15px;
            text-align: left;
            position: sticky;
            top: 0;
        }
        
        .evaluation-table td {
            padding: 12px 15px;
            /* border-bottom: 1px solid #eee; */
        }
        
        .evaluation-table tr:nth-child(even) {
            background-color: #f9f8ff;
        }
        
        .evaluation-table tr:hover {
            background-color: #f0edff;
        }
        
        .dimension-header {
            font-weight: bold;
            background: #5a4b9a !important;
            color: white;
        }
        
        .sub-dimension {
            font-weight: 600;
            background: #d1c9ff !important;
            color: #4a3d8f;
        }
        
        .evaluation-options {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .option-item {
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
            margin-top: 5px;
            margin-bottom: 5px;
        }
        
        .option-item input {
            cursor: pointer;
        }
        
        .health-check {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid #eae6ff;
        }
        
        .health-check h2 {
            color: #5a4b9a;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .input-group {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .input-item {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            font-weight: 600;
            color: #5a4b9a;
        }
        
        input[type="number"], select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background: #f9f8ff;
        }
        
        .result-box {
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: bold;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.05);
        }
        
        .result-excellent {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .result-warning {
            background: linear-gradient(135deg, #fff3cd, #ffeeba);
            color: #856404;
            border: 2px solid #ffeeba;
        }
        
        .result-danger {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #6c63a0;
            font-size: 0.9rem;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 12px;
        }
        
        .progress-container {
            margin: 20px 0;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 0.9rem;
            color: #5a4b9a;
        }
        
        .progress-bar {
            height: 12px;
            background: #e9e6ff;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #6a5acd, #8a7cf0);
            border-radius: 10px;
            transition: width 0.5s ease;
        }
        
        .summary-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid #eee;
        }
        
        .summary-card h3 {
            color: #5a4b9a;
            margin-bottom: 15px;
            border-bottom: 2px solid #f0edff;
            padding-bottom: 10px;
        }
        
        .stats-container {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            background: #f9f8ff;
            flex: 1;
            min-width: 150px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #6a5acd;
            margin: 10px 0;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #6c63a0;
        }
        
        .responsibility-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .responsibility-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0d6ff;
        }
        
        .responsibility-card h4 {
            color: #5a4b9a;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .responsibility-card h4 i {
            font-size: 1.5rem;
        }
        
        .responsibility-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #e9e6ff;
        }
        
        .responsibility-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .warning-card {
            background: linear-gradient(135deg, #fff9e6, #fff3d9);
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
        }
        
        .warning-card h4 {
            color: #856404;
        }
        
        @media (max-width: 768px) {
            .toolbar {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .evaluation-options {
                flex-wrap: wrap;
            }
            
            .option-item {
                flex: 1 0 40%;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <!-- <div class="header-badge">增强版</div> -->
            <h1>伴侣关系评估工具</h1>
            <p class="subtitle">全面评估责任感维度与常见误区，科学分析伴侣关系健康度</p>
        </header>
        
        <div class="toolbar">
            <button class="btn btn-import" onclick="importExcel()">
                <span>📥 导入数据</span>
            </button>
            <button class="btn btn-export" onclick="exportToExcel()">
                <span>📤 导出为Excel</span>
            </button>
            <input type="file" id="fileInput" style="display:none" accept=".xlsx, .xls" onchange="handleFile(this.files)">
            <button class="btn" onclick="calculateAllScores()">
                <span>📊 计算评估结果</span>
            </button>
            <button class="btn" onclick="resetForm()">
                <span>🔄 重置评估</span>
            </button>
        </div>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab(event, 'core-dimensions')">核心维度</button>
            <button class="tab-btn" onclick="openTab(event, 'behavior')">行为观察</button>
            <button class="tab-btn" onclick="openTab(event, 'responsibility')">责任感</button>
            <button class="tab-btn" onclick="openTab(event, 'mistakes')">常见误区</button>
            <button class="tab-btn" onclick="openTab(event, 'results')">评估结果</button>
        </div>
        
        <div id="core-dimensions" class="tab-content active">
            <h2>核心维度评估表</h2>
            <p>评估关系的核心基础维度，这些维度决定了关系的长期稳定性。</p>
            
            <table class="evaluation-table">
                <thead>
                    <tr>
                        <th width="20%">评估维度</th>
                        <th width="35%">关键指标</th>
                        <th width="45%">评估选项</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="dimension-header">
                        <td colspan="3">价值观契合</td>
                    </tr>
                    <tr>
                        <td>生活目标</td>
                        <td>对未来的规划是否一致</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="goal" value="4" id="goal4">
                                <label for="goal4">完全一致</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="goal" value="3" id="goal3">
                                <label for="goal3">基本一致</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="goal" value="2" id="goal2">
                                <label for="goal2">部分一致</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="goal" value="goal1">
                                <label for="goal1">差异较大</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>家庭观念</td>
                        <td>对家庭角色和责任的看法</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="family" value="4" id="family4">
                                <label for="family4">高度契合</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family" value="3" id="family3">
                                <label for="family3">比较契合</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family" value="2" id="family2">
                                <label for="family2">存在分歧</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family" value="1" id="family1">
                                <label for="family1">严重冲突</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>金钱观念</td>
                        <td>消费习惯和财务规划</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="money" value="4" id="money4">
                                <label for="money4">完全一致</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="money" value="3" id="money3">
                                <label for="money3">比较一致</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="money" value="2" id="money2">
                                <label for="money2">偶尔冲突</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="money" value="1" id="money1">
                                <label for="money1">经常冲突</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="dimension-header">
                        <td colspan="3">性格与相处</td>
                    </tr>
                    <tr>
                        <td>情绪稳定性</td>
                        <td>处理压力和情绪的方式</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="emotion" value="4" id="emotion4">
                                <label for="emotion4">非常稳定</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="emotion" value="3" id="emotion3">
                                <label for="emotion3">比较稳定</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="emotion" value="2" id="emotion2">
                                <label for="emotion2">偶尔波动</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="emotion" value="1" id="emotion1">
                                <label for="emotion1">很不稳定</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>相处舒适度</td>
                        <td>在一起时的自然感受</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="comfort" value="4" id="comfort4">
                                <label for="comfort4">非常舒适</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="comfort" value="3" id="comfort3">
                                <label for="comfort3">比较舒适</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="comfort" value="2" id="comfort2">
                                <label for="comfort2">感觉一般</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="comfort" value="1" id="comfort1">
                                <label for="comfort1">感到压力</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="dimension-header">
                        <td colspan="3">人品本质</td>
                    </tr>
                    <tr>
                        <td>诚实守信</td>
                        <td>承诺的兑现情况</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="honesty" value="4" id="honesty4">
                                <label for="honesty4">完全可信</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="honesty" value="3" id="honesty3">
                                <label for="honesty3">比较可信</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="honesty" value="2" id="honesty2">
                                <label for="honesty2">有时失信</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="honesty" value="1" id="honesty1">
                                <label for="honesty1">不可信赖</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>善良同理心</td>
                        <td>对待他人的态度</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="kindness" value="4" id="kindness4">
                                <label for="kindness4">非常善良</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="kindness" value="3" id="kindness3">
                                <label for="kindness3">比较善良</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="kindness" value="2" id="kindness2">
                                <label for="kindness2">偶尔冷漠</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="kindness" value="1" id="kindness1">
                                <label for="kindness1">缺乏同理心</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="dimension-header">
                        <td colspan="3">独立成长</td>
                    </tr>
                    <tr>
                        <td>个人发展</td>
                        <td>是否有自己的目标和兴趣</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="development" value="4" id="development4">
                                <label for="development4">目标明确</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="development" value="3" id="development3">
                                <label for="development3">比较明确</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="development" value="2" id="development2">
                                <label for="development2">目标模糊</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="development" value="1" id="development1">
                                <label for="development1">缺乏目标</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>共同成长</td>
                        <td>互相支持和促进</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="growth" value="4" id="growth4">
                                <label for="growth4">互相促进</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="growth" value="3" id="growth3">
                                <label for="growth3">比较支持</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="growth" value="2" id="growth2">
                                <label for="growth2">偶尔支持</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="growth" value="1" id="growth1">
                                <label for="growth1">缺乏支持</label>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div id="behavior" class="tab-content">
            <h2>行为观察对照表</h2>
            <p>通过具体行为观察关系质量，这些行为是内在品质的外在表现。</p>
            
            <table class="evaluation-table">
                <thead>
                    <tr>
                        <th width="25%">观察场景</th>
                        <th width="35%">具体方法</th>
                        <th width="40%">评估选项</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>日常互动</td>
                        <td>观察对待服务人员/陌生人的态度</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="daily" value="4" id="daily4">
                                <label for="daily4">非常尊重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="daily" value="3" id="daily3">
                                <label for="daily2">有时尊重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="daily" value="2" id="daily2">
                                <label for="daily2">偶尔失礼</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="daily" value="1" id="daily1">
                                <label for="daily1">缺乏尊重</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>压力测试</td>
                        <td>共同处理困难事件（旅行/项目合作）</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="stress" value="4" id="stress4">
                                <label for="stress4">合作默契</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="stress" value="3" id="stress3">
                                <label for="stress3">比较合作</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="stress" value="2" id="stress2">
                                <label for="stress2">时有冲突</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="stress" value="1" id="stress1">
                                <label for="stress1">互相指责</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>深度对话</td>
                        <td>讨论时事/分享经历时探讨价值观</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="conversation" value="4" id="conversation4">
                                <label for="conversation4">深入交流</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="conversation" value="3" id="conversation3">
                                <label for="conversation3">能够交流</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="conversation" value="2" id="conversation2">
                                <label for="conversation2">偶尔交流</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="conversation" value="1" id="conversation1">
                                <label for="conversation1">避免交流</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>社交圈层</td>
                        <td>接触对方朋友家人</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="social" value="4" id="social4">
                                <label for="social4">非常融洽</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="social" value="3" id="social3">
                                <label for="social3">比较融洽</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="social" value="2" id="social2">
                                <label for="social2">感觉一般</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="social" value="1" id="social1">
                                <label for="social1">不太融洽</label>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 责任感评估标签页 -->
        <div id="responsibility" class="tab-content">
            <h2>责任感维度评估</h2>
            <p>全面评估个人责任感表现，包含自我责任、社会责任和情绪行为成熟度</p>
            
            <table class="evaluation-table">
                <thead>
                    <tr>
                        <th width="20%">评估维度</th>
                        <th width="35%">关键指标</th>
                        <th width="45%">评估选项</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="dimension-header">
                        <td colspan="3">自我责任感（对自己负责）</td>
                    </tr>
                    <tr class="sub-dimension">
                        <td colspan="3">个人管理</td>
                    </tr>
                    <tr>
                        <td>个人卫生</td>
                        <td>日常清洁、仪容仪表</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="hygiene" value="4" id="hygiene4">
                                <label for="hygiene4">非常注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="hygiene" value="3" id="hygiene3">
                                <label for="hygiene3">比较注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="hygiene" value="2" id="hygiene2">
                                <label for="hygiene2">一般水平</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="hygiene" value="1" id="hygiene1">
                                <label for="hygiene1">不太注重</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>居住环境</td>
                        <td>居家整洁度、物品管理</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="environment" value="4" id="environment4">
                                <label for="environment4">整洁有序</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="environment" value="3" id="environment3">
                                <label for="environment3">比较整洁</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="environment" value="2" id="environment2">
                                <label for="environment2">偶尔整理</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="environment" value="1" id="environment1">
                                <label for="environment1">杂乱无序</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="sub-dimension">
                        <td colspan="3">财务规划</td>
                    </tr>
                    <tr>
                        <td>消费习惯</td>
                        <td>理性消费、避免冲动</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="spending" value="4" id="spending4">
                                <label for="spending4">非常理性</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="spending" value="3" id="spending3">
                                <label for="spending3">比较理性</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="spending" value="2" id="spending2">
                                <label for="spending2">偶尔冲动</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="spending" value="1" id="spending1">
                                <label for="spending1">经常冲动</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>储蓄投资</td>
                        <td>定期储蓄、理财规划</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="saving" value="4" id="saving4">
                                <label for="saving4">规划清晰</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="saving" value="3" id="saving3">
                                <label for="saving3">有储蓄习惯</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="saving" value="2" id="saving2">
                                <label for="saving2">偶尔储蓄</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="saving" value="1" id="saving1">
                                <label for="saving1">无储蓄习惯</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="sub-dimension">
                        <td colspan="3">职业发展</td>
                    </tr>
                    <tr>
                        <td>工作态度</td>
                        <td>责任心、敬业精神</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="work" value="4" id="work4">
                                <label for="work4">高度负责</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="work" value="3" id="work3">
                                <label for="work3">比较负责</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="work" value="2" id="work2">
                                <label for="work2">一般负责</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="work" value="1" id="work1">
                                <label for="work1">不太负责</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>职业规划</td>
                        <td>目标设定、技能提升</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="career" value="4" id="career4">
                                <label for="career4">清晰长远</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="career" value="3" id="career3">
                                <label for="career3">有规划</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="career" value="2" id="career2">
                                <label for="career2">短期规划</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="career" value="1" id="career1">
                                <label for="career1">缺乏规划</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="sub-dimension">
                        <td colspan="3">健康管理</td>
                    </tr>
                    <tr>
                        <td>饮食运动</td>
                        <td>均衡饮食、规律运动</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="health" value="4" id="health4">
                                <label for="health4">非常注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="health" value="3" id="health3">
                                <label for="health3">比较注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="health" value="2" id="health2">
                                <label for="health2">偶尔注意</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="health" value="1" id="health1">
                                <label for="health1">不太注重</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>健康维护</td>
                        <td>定期体检、不良嗜好控制</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="maintenance" value="4" id="maintenance4">
                                <label for="maintenance4">非常自律</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="maintenance" value="3" id="maintenance3">
                                <label for="maintenance3">比较自律</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="maintenance" value="2" id="maintenance2">
                                <label for="maintenance2">偶尔注意</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="maintenance" value="1" id="maintenance1">
                                <label for="maintenance1">不太注意</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="dimension-header">
                        <td colspan="3">社会责任感（对他人负责）</td>
                    </tr>
                    <tr class="sub-dimension">
                        <td colspan="3">家庭责任</td>
                    </tr>
                    <tr>
                        <td>关心照顾</td>
                        <td>对家人的关心程度</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="family_care" value="4" id="family_care4">
                                <label for="family_care4">非常关心</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family_care" value="3" id="family_care3">
                                <label for="family_care3">比较关心</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family_care" value="2" id="family_care2">
                                <label for="family_care2">偶尔关心</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family_care" value="1" id="family_care1">
                                <label for="family_care1">不太关心</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>履行义务</td>
                        <td>承担家庭责任和义务</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="family_duty" value="4" id="family_duty4">
                                <label for="family_duty4">主动承担</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family_duty" value="3" id="family_duty3">
                                <label for="family_duty3">愿意承担</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family_duty" value="2" id="family_duty2">
                                <label for="family_duty2">需要提醒</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="family_duty" value="1" id="family_duty1">
                                <label for="family_duty1">逃避责任</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="sub-dimension">
                        <td colspan="3">伴侣责任</td>
                    </tr>
                    <tr>
                        <td>情感支持</td>
                        <td>在伴侣需要时的支持</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="partner_support" value="4" id="partner_support4">
                                <label for="partner_support4">非常支持</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="partner_support" value="3" id="partner_support3">
                                <label for="partner_support3">比较支持</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="partner_support" value="2" id="partner_support2">
                                <label for="partner_support2">偶尔支持</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="partner_support" value="1" id="partner_support1">
                                <label for="partner_support1">不太支持</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>共同决策</td>
                        <td>重要事务的商议决定</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="decision" value="4" id="decision4">
                                <label for="decision4">充分商议</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="decision" value="3" id="decision3">
                                <label for="decision3">多数商议</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="decision" value="2" id="decision2">
                                <label for="decision2">偶尔商议</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="decision" value="1" id="decision1">
                                <label for="decision1">独自决定</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="sub-dimension">
                        <td colspan="3">社会责任</td>
                    </tr>
                    <tr>
                        <td>公德意识</td>
                        <td>遵守公共秩序和规则</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="public" value="4" id="public4">
                                <label for="public4">高度遵守</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="public" value="3" id="public3">
                                <label for="public3">比较遵守</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="public" value="2" id="public2">
                                <label for="public2">偶尔违反</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="public" value="1" id="public1">
                                <label for="public1">经常违反</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>环境保护</td>
                        <td>环保意识、资源节约</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="environmental" value="4" id="environmental4">
                                <label for="environmental4">非常注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="environmental" value="3" id="environmental3">
                                <label for="environmental3">比较注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="environmental" value="2" id="environmental2">
                                <label for="environmental2">偶尔注意</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="environmental" value="1" id="environmental1">
                                <label for="environmental1">不太注意</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="dimension-header">
                        <td colspan="3">情绪与行为成熟</td>
                    </tr>
                    <tr class="sub-dimension">
                        <td colspan="3">情绪稳定性</td>
                    </tr>
                    <tr>
                        <td>压力应对</td>
                        <td>面对压力时的情绪控制</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="stress_management" value="4" id="stress_management4">
                                <label for="stress_management4">非常稳定</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="stress_management" value="3" id="stress_management3">
                                <label for="stress_management3">比较稳定</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="stress_management" value="2" id="stress_management2">
                                <label for="stress_management2">偶尔失控</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="stress_management" value="1" id="stress_management1">
                                <label for="stress_management1">经常失控</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>问题解决</td>
                        <td>理性分析、积极解决</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="problem_solving" value="4" id="problem_solving4">
                                <label for="problem_solving4">非常理性</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="problem_solving" value="3" id="problem_solving3">
                                <label for="problem_solving3">比较理性</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="problem_solving" value="2" id="problem_solving2">
                                <label for="problem_solving2">偶尔情绪化</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="problem_solving" value="1" id="problem_solving1">
                                <label for="problem_solving1">非常情绪化</label>
                            </div>
                        </td>
                    </tr>
                    
                    <tr class="sub-dimension">
                        <td colspan="3">行为成熟度</td>
                    </tr>
                    <tr>
                        <td>承认错误</td>
                        <td>认错态度、改正行动</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="admit_mistakes" value="4" id="admit_mistakes4">
                                <label for="admit_mistakes4">主动认错</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="admit_mistakes" value="3" id="admit_mistakes3">
                                <label for="admit_mistakes3">愿意认错</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="admit_mistakes" value="2" id="admit_mistakes2">
                                <label for="admit_mistakes2">勉强认错</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="admit_mistakes" value="1" id="admit_mistakes1">
                                <label for="admit_mistakes1">拒绝认错</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>长远眼光</td>
                        <td>为未来做准备的意识和行动</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="long_term" value="4" id="long_term4">
                                <label for="long_term4">非常注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="long_term" value="3" id="long_term3">
                                <label for="long_term3">比较注重</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="long_term" value="2" id="long_term2">
                                <label for="long_term2">偶尔考虑</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="long_term" value="1" id="long_term1">
                                <label for="long_term1">很少考虑</label>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- 新增常见误区标签页 -->
        <div id="mistakes" class="tab-content">
            <h2>关键误区警示表</h2>
            <p>关系中需要警惕的常见陷阱和错误认知。</p>
            
            <div class="warning-card">
                <h4>⚠️ 评估说明</h4>
                <p>本部分评估您在关系中的认知误区，得分越高表示您越能避免这些常见错误</p>
            </div>
            
            <table class="evaluation-table">
                <thead>
                    <tr>
                        <th width="25%">危险信号</th>
                        <th width="35%">错误认知</th>
                        <th width="40%">评估选项</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>完美主义</td>
                        <td>要求满足所有理想条件</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="perfection" value="4" id="perfection4">
                                <label for="perfection4">非常包容</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="perfection" value="3" id="perfection3">
                                <label for="perfection3">比较包容</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="perfection" value="2" id="perfection2">
                                <label for="perfection2">要求较高</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="perfection" value="1" id="perfection1">
                                <label for="perfection1">追求完美</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>光环效应</td>
                        <td>因外貌/才华忽略人品缺陷</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="halo" value="4" id="halo4">
                                <label for="halo4">非常理性</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="halo" value="3" id="halo3">
                                <label for="halo3">比较理性</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="halo" value="2" id="halo2">
                                <label for="halo2">时有影响</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="halo" value="1" id="halo1">
                                <label for="halo1">影响严重</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>单边筛选</td>
                        <td>只要求对方优质不自省</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="selfcheck" value="4" id="selfcheck4">
                                <label for="selfcheck4">经常自省</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="selfcheck" value="3" id="selfcheck3">
                                <label for="selfcheck3">偶尔自省</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="selfcheck" value="2" id="selfcheck2">
                                <label for="selfcheck2">很少自省</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="selfcheck" value="1" id="selfcheck1">
                                <label for="selfcheck1">从不自省</label>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>速成心态</td>
                        <td>急于确定关系</td>
                        <td class="evaluation-options">
                            <div class="option-item">
                                <input type="radio" name="speed" value="4" id="speed4">
                                <label for="speed4">非常耐心</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="speed" value="3" id="speed3">
                                <label for="speed3">比较耐心</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="speed" value="2" id="speed2">
                                <label for="speed2">有些着急</label>
                            </div>
                            <div class="option-item">
                                <input type="radio" name="speed" value="1" id="speed1">
                                <label for="speed1">非常着急</label>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div id="results" class="tab-content">
            <h2>关系评估结果</h2>
            <p>根据您的选择计算的关系健康度分析</p>
            
            <div class="summary-card">
                <h3>总体评估</h3>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>关系健康度</span>
                        <span id="health-percentage">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="health-progress" style="width: 0%"></div>
                    </div>
                </div>
                
                <div id="overall-result" class="result-box">
                    请完成评估并点击"计算评估结果"按钮
                </div>
            </div>
            
            <div class="summary-card">
                <h3>维度分析</h3>
                <div class="stats-container">
                    <div class="stat-item">
                        <div class="stat-label">价值观契合</div>
                        <div class="stat-value" id="values-score">0</div>
                        <div class="stat-label">/12分</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">性格相处</div>
                        <div class="stat-value" id="personality-score">0</div>
                        <div class="stat-label">/8分</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">人品本质</div>
                        <div class="stat-value" id="character-score">0</div>
                        <div class="stat-label">/8分</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">独立成长</div>
                        <div class="stat-value" id="growth-score">0</div>
                        <div class="stat-label">/8分</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">责任感</div>
                        <div class="stat-value" id="responsibility-score">0</div>
                        <div class="stat-label">/48分</div>
                    </div>
                    <!-- 新增常见误区维度 -->
                    <div class="stat-item">
                        <div class="stat-label">误区规避</div>
                        <div class="stat-value" id="mistakes-score">0</div>
                        <div class="stat-label">/16分</div>
                    </div>
                </div>
            </div>
            
            <div class="summary-card">
                <h3>责任感维度分析</h3>
                <div class="responsibility-grid">
                    <div class="responsibility-card">
                        <h4>自我责任感</h4>
                        <div class="responsibility-item">
                            <strong>个人管理：</strong>
                            <span id="self-management-score">0</span>/8
                        </div>
                        <div class="responsibility-item">
                            <strong>财务规划：</strong>
                            <span id="finance-score">0</span>/8
                        </div>
                        <div class="responsibility-item">
                            <strong>职业发展：</strong>
                            <span id="career-score">0</span>/8
                        </div>
                        <div class="responsibility-item">
                            <strong>健康管理：</strong>
                            <span id="health-score">0</span>/8
                        </div>
                    </div>
                    
                    <div class="responsibility-card">
                        <h4>社会责任感</h4>
                        <div class="responsibility-item">
                            <strong>家庭责任：</strong>
                            <span id="family-score">0</span>/8
                        </div>
                        <div class="responsibility-item">
                            <strong>伴侣责任：</strong>
                            <span id="partner-score">0</span>/8
                        </div>
                        <div class="responsibility-item">
                            <strong>社会责任：</strong>
                            <span id="social-score">0</span>/8
                        </div>
                    </div>
                    
                    <div class="responsibility-card">
                        <h4>情绪与行为成熟</h4>
                        <div class="responsibility-item">
                            <strong>情绪稳定性：</strong>
                            <span id="emotion-score">0</span>/8
                        </div>
                        <div class="responsibility-item">
                            <strong>行为成熟度：</strong>
                            <span id="behavior-score">0</span>/8
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="summary-card">
                <h3>改进建议</h3>
                <div id="suggestions" class="result-box result-warning">
                    完成评估后，将根据结果提供具体改进建议
                </div>
            </div>
        </div>
        
        <footer>
            <p>© 2025 伴侣关系评估工具</p>
            <p>注：工具结果仅供参考，健康关系需要双方共同经营和维护</p>
        </footer>
    </div>

    <script>
        // 标签页切换功能（已修复）
        function openTab(event, tabName) {
            // 隐藏所有标签内容
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            // 移除所有标签按钮的active类
            const tabButtons = document.getElementsByClassName("tab-btn");
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            
            // 显示当前标签内容
            document.getElementById(tabName).classList.add("active");
            
            // 设置当前标签按钮为active
            event.currentTarget.classList.add("active");
        }
        
        // 计算所有分数
        function calculateAllScores() {
            // 核心维度评分
            const valuesScore = calculateSectionScore(['goal', 'family', 'money']);
            document.getElementById('values-score').textContent = valuesScore;
            
            // 性格相处评分
            const personalityScore = calculateSectionScore(['emotion', 'comfort']);
            document.getElementById('personality-score').textContent = personalityScore;
            
            // 人品本质评分
            const characterScore = calculateSectionScore(['honesty', 'kindness']);
            document.getElementById('character-score').textContent = characterScore;
            
            // 独立成长评分
            const growthScore = calculateSectionScore(['development', 'growth']);
            document.getElementById('growth-score').textContent = growthScore;
            
            // 责任感维度评分
            // 自我责任感
            const selfManagementScore = calculateSectionScore(['hygiene', 'environment']);
            document.getElementById('self-management-score').textContent = selfManagementScore;
            
            const financeScore = calculateSectionScore(['spending', 'saving']);
            document.getElementById('finance-score').textContent = financeScore;
            
            const careerScore = calculateSectionScore(['work', 'career']);
            document.getElementById('career-score').textContent = careerScore;
            
            const healthScore = calculateSectionScore(['health', 'maintenance']);
            document.getElementById('health-score').textContent = healthScore;
            
            // 社会责任感
            const familyScore = calculateSectionScore(['family_care', 'family_duty']);
            document.getElementById('family-score').textContent = familyScore;
            
            const partnerScore = calculateSectionScore(['partner_support', 'decision']);
            document.getElementById('partner-score').textContent = partnerScore;
            
            const socialScore = calculateSectionScore(['public', 'environmental']);
            document.getElementById('social-score').textContent = socialScore;
            
            // 情绪与行为成熟
            const emotionScore = calculateSectionScore(['stress_management', 'problem_solving']);
            document.getElementById('emotion-score').textContent = emotionScore;
            
            const behaviorScore = calculateSectionScore(['admit_mistakes', 'long_term']);
            document.getElementById('behavior-score').textContent = behaviorScore;
            
            // 责任感总分
            const responsibilityScore = selfManagementScore + financeScore + careerScore + healthScore + 
                                      familyScore + partnerScore + socialScore + 
                                      emotionScore + behaviorScore;
            document.getElementById('responsibility-score').textContent = responsibilityScore;
            
            // 常见误区评分（新增部分）
            const mistakesScore = calculateSectionScore(['perfection', 'halo', 'selfcheck', 'speed']);
            document.getElementById('mistakes-score').textContent = mistakesScore;
            
            // 计算总分（原84分 + 新增误区16分 = 100分）
            const totalScore = valuesScore + personalityScore + characterScore + growthScore + 
                              responsibilityScore + mistakesScore;
            const percentage = Math.round((totalScore / 100) * 100);
            
            // 更新进度条
            document.getElementById('health-percentage').textContent = percentage + '%';
            document.getElementById('health-progress').style.width = percentage + '%';
            
            // 显示结果
            const resultBox = document.getElementById('overall-result');
            resultBox.className = "result-box";
            
            if (percentage >= 80) {
                resultBox.classList.add("result-excellent");
                resultBox.innerHTML = `
                    <h3>✅ 健康等级：优质关系</h3>
                    <p>综合得分: ${totalScore}/100 (${percentage}%)</p>
                    <p>责任感得分: ${responsibilityScore}/48</p>
                    <p>误区规避得分: ${mistakesScore}/16</p>
                    <p>你们的关系非常健康稳固，责任感表现优秀</p>
                    <p>继续保持良好的沟通和相互支持</p>
                `;
            } else if (percentage >= 60) {
                resultBox.classList.add("result-warning");
                resultBox.innerHTML = `
                    <h3>⚠️ 健康等级：待优化关系</h3>
                    <p>综合得分: ${totalScore}/100 (${percentage}%)</p>
                    <p>责任感得分: ${responsibilityScore}/48</p>
                    <p>误区规避得分: ${mistakesScore}/16</p>
                    <p>需关注短板领域，加强责任感建设</p>
                    <p>建议每月进行一次深度沟通，解决分歧</p>
                `;
            } else {
                resultBox.classList.add("result-danger");
                resultBox.innerHTML = `
                    <h3>❌ 健康等级：高风险关系</h3>
                    <p>综合得分: ${totalScore}/100 (${percentage}%)</p>
                    <p>责任感得分: ${responsibilityScore}/48</p>
                    <p>误区规避得分: ${mistakesScore}/16</p>
                    <p>责任感维度存在严重问题，建议深度反思</p>
                    <p>请关注关系中存在的根本性问题</p>
                `;
            }
            
            // 更新建议
            updateSuggestions(totalScore, responsibilityScore, mistakesScore);
        }
        
        // 计算部分分数
        function calculateSectionScore(names) {
            let score = 0;
            names.forEach(name => {
                const selected = document.querySelector(`input[name="${name}"]:checked`);
                if (selected) {
                    score += parseInt(selected.value);
                }
            });
            return score;
        }
        
        // 更新建议
        function updateSuggestions(totalScore, responsibilityScore, mistakesScore) {
            const suggestionsBox = document.getElementById('suggestions');
            
            if (totalScore >= 80) {
                suggestionsBox.className = "result-box result-excellent";
                suggestionsBox.innerHTML = `
                    <h4>💡 保持建议</h4>
                    <p>1. 继续保持定期深度沟通，分享彼此感受</p>
                    <p>2. 定期安排"关系检查"时间，讨论双方需求</p>
                    <p>3. 共同设定新目标，保持关系活力</p>
                    <p>4. 责任感得分(${responsibilityScore}/48)表现优秀，继续保持</p>
                    <p>5. 误区规避得分(${mistakesScore}/16)良好，继续保持理性认知</p>
                `;
            } else if (totalScore >= 60) {
                suggestionsBox.className = "result-box result-warning";
                
                let responsibilityTip = "";
                if (responsibilityScore < 30) {
                    responsibilityTip = `<p>4. 责任感得分(${responsibilityScore}/48)较低，需加强自我管理和伴侣责任</p>`;
                } else if (responsibilityScore < 38) {
                    responsibilityTip = `<p>4. 责任感得分(${responsibilityScore}/48)中等，可提升社会责任感</p>`;
                } else {
                    responsibilityTip = `<p>4. 责任感得分(${responsibilityScore}/48)良好，可进一步提升情绪成熟度</p>`;
                }
                
                let mistakesTip = "";
                if (mistakesScore < 10) {
                    mistakesTip = `<p>5. 误区规避得分(${mistakesScore}/16)较低，需警惕完美主义和光环效应</p>`;
                } else if (mistakesScore < 13) {
                    mistakesTip = `<p>5. 误区规避得分(${mistakesScore}/16)中等，需注意单边筛选问题</p>`;
                } else {
                    mistakesTip = `<p>5. 误区规避得分(${mistakesScore}/16)良好，可进一步提升</p>`;
                }
                
                suggestionsBox.innerHTML = `
                    <h4>💡 改进建议</h4>
                    <p>1. 重点关注价值观差异领域，寻找共同点</p>
                    <p>2. 学习有效沟通技巧，避免指责性语言</p>
                    <p>3. 每月安排专门时间解决未决问题</p>
                    ${responsibilityTip}
                    ${mistakesTip}
                `;
            } else {
                suggestionsBox.className = "result-box result-danger";
                
                let responsibilityTip = "";
                if (responsibilityScore < 24) {
                    responsibilityTip = `<p>4. 责任感得分(${responsibilityScore}/48)严重不足，是关系的主要风险点</p>`;
                } else {
                    responsibilityTip = `<p>4. 责任感得分(${responsibilityScore}/48)较低，需要特别关注</p>`;
                }
                
                let mistakesTip = "";
                if (mistakesScore < 8) {
                    mistakesTip = `<p>5. 误区规避得分(${mistakesScore}/16)严重不足，存在重大认知误区</p>`;
                } else {
                    mistakesTip = `<p>5. 误区规避得分(${mistakesScore}/16)较低，需重新审视关系认知</p>`;
                }
                
                suggestionsBox.innerHTML = `
                    <h4>💡 改进建议</h4>
                    <p>1. 优先解决关系中的核心冲突问题</p>
                    <p>2. 考虑寻求专业关系咨询师帮助</p>
                    <p>3. 重新评估关系基础是否健康可持续</p>
                    ${responsibilityTip}
                    ${mistakesTip}
                `;
            }
        }
        
        // Excel导出功能
        function exportToExcel() {
            // 创建工作簿
            const wb = XLSX.utils.book_new();
            
            // 添加核心维度表
            const coreTable = document.getElementById("core-dimensions").getElementsByTagName("table")[0];
            const coreWs = XLSX.utils.table_to_sheet(coreTable);
            XLSX.utils.book_append_sheet(wb, coreWs, "核心维度");
            
            // 添加行为观察表
            const behaviorTable = document.getElementById("behavior").getElementsByTagName("table")[0];
            const behaviorWs = XLSX.utils.table_to_sheet(behaviorTable);
            XLSX.utils.book_append_sheet(wb, behaviorWs, "行为观察");
            
            // 添加责任感评估表
            const respTable = document.getElementById("responsibility").getElementsByTagName("table")[0];
            const respWs = XLSX.utils.table_to_sheet(respTable);
            XLSX.utils.book_append_sheet(wb, respWs, "责任感评估");
            
            // 添加常见误区表
            const mistakesTable = document.getElementById("mistakes").getElementsByTagName("table")[0];
            const mistakesWs = XLSX.utils.table_to_sheet(mistakesTable);
            XLSX.utils.book_append_sheet(wb, mistakesWs, "常见误区");
            
            // 导出文件
            XLSX.writeFile(wb, "伴侣关系评估.xlsx");
        }
        
        // Excel导入功能
        function importExcel() {
            document.getElementById("fileInput").click();
        }
        
        function handleFile(files) {
            const file = files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = new Uint8Array(e.target.result);
                const workbook = XLSX.read(data, {type: 'array'});
                
                // 提示导入成功
                alert("数据导入成功！请查看各表格中的数据更新");
                
                // 在实际应用中，这里可以添加代码来更新页面上的表格
                // 但考虑到安全性和复杂性，这里仅做提示
            };
            reader.readAsArrayBuffer(file);
        }
        
        // 重置表单
        function resetForm() {
            const allRadios = document.querySelectorAll('input[type="radio"]');
            allRadios.forEach(radio => {
                radio.checked = false;
            });
            
            // 重置结果展示
            document.getElementById('health-percentage').textContent = '0%';
            document.getElementById('health-progress').style.width = '0%';
            document.getElementById('overall-result').className = "result-box";
            document.getElementById('overall-result').innerHTML = "请完成评估并点击'计算评估结果'按钮";
            
            // 重置所有分数显示
            const scoreElements = document.querySelectorAll('.stat-value, [id$="-score"]');
            scoreElements.forEach(el => {
                el.textContent = '0';
            });
            
            document.getElementById('suggestions').className = "result-box result-warning";
            document.getElementById('suggestions').innerHTML = "完成评估后，将根据结果提供具体改进建议";
            
            alert("评估表已重置，请重新填写！");
        }
    
    </script>
</body>
</html>